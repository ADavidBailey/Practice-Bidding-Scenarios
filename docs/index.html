<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBS Activity Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 13px;
            max-width: 1100px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
            color: #333333;
        }
        h1 {
            color: #222222;
            text-align: center;
            margin-bottom: 10px;
            font-size: 22px;
        }
        .subtitle {
            text-align: center;
            color: #666666;
            margin-bottom: 30px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        .stat-box {
            background: #ffffff;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #0077b6;
        }
        .stat-label {
            color: #666666;
            margin-top: 5px;
            font-size: 12px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-card {
            background: #ffffff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        .chart-card h3 {
            margin: 0 0 15px 0;
            color: #333333;
            font-size: 14px;
        }
        .activity-card {
            background: #ffffff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .activity-card h3 {
            margin: 0 0 15px 0;
            color: #333333;
        }
        .activity-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .activity-list {
            max-height: 250px;
            overflow-y: auto;
        }
        .activity-item {
            padding: 6px 10px;
            border-bottom: 1px solid #e5e5e5;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .activity-item:last-child {
            border-bottom: none;
        }
        .activity-type {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
        }
        .type-file_save { background: #dbeafe; color: #1d4ed8; }
        .type-pipeline_run { background: #dcfce7; color: #15803d; }
        .type-session_start { background: #fef3c7; color: #b45309; }
        .type-session_end { background: #fee2e2; color: #b91c1c; }
        .activity-time {
            color: #888888;
            font-size: 10px;
        }
        .commit-item {
            padding: 6px 10px;
            border-bottom: 1px solid #e5e5e5;
            font-size: 11px;
        }
        .commit-item:last-child {
            border-bottom: none;
        }
        .commit-hash {
            font-family: monospace;
            color: #7c3aed;
            font-size: 10px;
        }
        .commit-message {
            color: #444444;
            margin-left: 8px;
        }
        .commit-date {
            color: #888888;
            font-size: 11px;
            display: block;
            margin-top: 4px;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888888;
            font-size: 14px;
        }
        .footer code {
            color: #7c3aed;
            background: #f0ecf9;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .no-data {
            color: #888888;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }
        @media (max-width: 900px) {
            .stats { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 600px) {
            .stats { grid-template-columns: repeat(2, 1fr); }
            .chart-grid { grid-template-columns: 1fr; }
            .activity-grid { grid-template-columns: 1fr; }
        }
    </style>
    <script>
const DASHBOARD_DATA = {
  "generatedAt": "2026-02-12T09:00:58.094566",
  "summary": {
    "totalScenarios": 298,
    "scenariosWorked": 298,
    "totalFileEdits": 50753,
    "totalPipelineRuns": 809,
    "totalSessionHours": 3198,
    "totalCommits": 5460
  },
  "charts": {
    "labels": [
      "Oct 23",
      "Nov 23",
      "Dec 23",
      "Jan 24",
      "Feb 24",
      "Mar 24",
      "Apr 24",
      "May 24",
      "Jun 24",
      "Jul 24",
      "Aug 24",
      "Sep 24",
      "Oct 24",
      "Nov 24",
      "Dec 24",
      "Jan 25",
      "Feb 25",
      "Mar 25",
      "Apr 25",
      "May 25",
      "Jun 25",
      "Jul 25",
      "Aug 25",
      "Sep 25",
      "Oct 25",
      "Nov 25",
      "Dec 25",
      "Jan 26",
      "Feb 26"
    ],
    "fileEdits": [
      182,
      450,
      423,
      253,
      292,
      377,
      243,
      4406,
      5419,
      2185,
      232,
      767,
      12932,
      7709,
      585,
      998,
      819,
      1572,
      1508,
      3782,
      595,
      314,
      250,
      870,
      1779,
      678,
      506,
      95,
      532
    ],
    "pipelineRuns": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      61,
      748
    ],
    "commits": [
      202,
      502,
      441,
      259,
      304,
      391,
      255,
      82,
      209,
      187,
      41,
      175,
      297,
      490,
      111,
      87,
      80,
      132,
      116,
      65,
      66,
      30,
      21,
      93,
      159,
      80,
      62,
      228,
      295
    ],
    "sessionHours": [
      77,
      145,
      171,
      75,
      140,
      158,
      83,
      66,
      143,
      158,
      47,
      141,
      204,
      206,
      113,
      75,
      76,
      83,
      112,
      58,
      70,
      37,
      35,
      100,
      131,
      102,
      69,
      97,
      226
    ],
    "scenariosWorked": [
      9,
      56,
      71,
      83,
      108,
      112,
      122,
      128,
      130,
      167,
      168,
      175,
      182,
      198,
      210,
      217,
      227,
      240,
      247,
      254,
      258,
      258,
      259,
      261,
      272,
      275,
      281,
      298,
      298
    ]
  },
  "recentActivity": [
    {
      "timestamp": "2026-02-12T03:26:00.821Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T03:26:07.936Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T03:28:13.829Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T03:28:20.009Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T03:33:21.163Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T03:33:25.896Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T03:41:18.669Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T03:41:22.990Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:30:34.543Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:35:19.281Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:35:29.579Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:38:44.866Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:38:53.605Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:43:03.952Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:43:08.672Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:49:13.868Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:50:09.947Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:50:14.362Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-02-12T14:53:34.225Z",
      "type": "file_save",
      "details": {
        "filePath": "btn/Maximal_After_Overcall.btn",
        "fileType": "btn"
      }
    },
    {
      "timestamp": "2026-02-12T14:53:49.840Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Maximal_After_Overcall",
        "operation": "*"
      }
    }
  ],
  "recentCommits": [
    {
      "hash": "a82dd33c",
      "date": "2026-02-11 20:17:57 -0600",
      "message": "Fix Maximal_After_Overcall button text double space and regenerate"
    },
    {
      "hash": "e04589b4",
      "date": "2026-02-11 20:17:22 -0600",
      "message": "Release Maximal_After_Overcall to pbs-release"
    },
    {
      "hash": "e4bd4273",
      "date": "2026-02-11 20:13:30 -0600",
      "message": "Add Maximal_After_Overcall to release button layout"
    },
    {
      "hash": "feccdc4a",
      "date": "2026-02-11 20:08:51 -0600",
      "message": "Release Maximal_After_Overcall to pbs-release"
    },
    {
      "hash": "cb26ae60",
      "date": "2026-02-11 20:00:42 -0600",
      "message": "Release Maximal_After_Overcall to pbs-release"
    },
    {
      "hash": "cfff86de",
      "date": "2026-02-11 19:59:24 -0600",
      "message": "Add Maximal_After_Overcall to beta button layout"
    },
    {
      "hash": "b41d26d0",
      "date": "2026-02-11 19:36:33 -0600",
      "message": "Revert wide comma replacement in generate_dlr scenario-title"
    },
    {
      "hash": "81a441de",
      "date": "2026-02-11 19:18:46 -0600",
      "message": "Update Maximal_After_Overcall button text and regenerate pipeline"
    },
    {
      "hash": "db74040f",
      "date": "2026-02-11 19:16:23 -0600",
      "message": "Replace comma-space with wide comma in DLR scenario-title"
    },
    {
      "hash": "eeb315ed",
      "date": "2026-02-11 16:41:17 -0600",
      "message": "Refine Maximal_After_Overcall constraints and regenerate pipeline"
    }
  ]
};
    </script>
</head>
<body>
    <h1>Practice Bidding Scenarios</h1>
    <p class="subtitle">Development Activity Dashboard</p>

    <div class="stats">
        <div class="stat-box">
            <div class="stat-value" id="scenarioCount">-</div>
            <div class="stat-label">Scenarios</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="commitCount">-</div>
            <div class="stat-label">Commits (Year)</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="sessionHours">-</div>
            <div class="stat-label">Hours in VSCode</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="pipelineRuns">-</div>
            <div class="stat-label">Pipeline Runs</div>
        </div>
    </div>

    <div class="chart-card" style="margin-bottom: 20px;">
        <h3>Cumulative Scenarios</h3>
        <canvas id="scenariosChart"></canvas>
    </div>

    <div class="chart-grid">
        <div class="chart-card">
            <h3>Git Commits</h3>
            <canvas id="commitsChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>File Edits</h3>
            <canvas id="editsChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>Pipeline Runs</h3>
            <canvas id="pipelineChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>VSCode Session Time (Hours)</h3>
            <canvas id="sessionChart"></canvas>
        </div>
    </div>

    <div class="activity-grid">
        <div class="activity-card">
            <h3>Recent Activity</h3>
            <div class="activity-list" id="recentActivity">
                <div class="no-data">No activity logged yet</div>
            </div>
        </div>
        <div class="activity-card">
            <h3>Recent Commits</h3>
            <div class="activity-list" id="recentCommits">
                <div class="no-data">No commits found</div>
            </div>
        </div>
    </div>

    <p class="footer">
        Last updated: <span id="lastUpdated">-</span>
        <br>
        <small>Auto-updates daily at 3 AM Central, or run <code>python3 docs/generateDashboardData.py</code></small>
    </p>

    <script>
        // Chart configuration defaults
        const chartDefaults = {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { stepSize: 1, color: '#666666' },
                    grid: { color: '#e5e5e5' }
                },
                x: {
                    ticks: { color: '#666666' },
                    grid: { color: '#e5e5e5' }
                }
            }
        };

        function createChart(canvasId, label, data, color) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels || [],
                    datasets: [{
                        label: label,
                        data: data.values || [],
                        backgroundColor: color + '40',
                        borderColor: color,
                        borderWidth: 1
                    }]
                },
                options: chartDefaults
            });
        }

        function formatTime(isoString) {
            try {
                const date = new Date(isoString);
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            } catch {
                return isoString;
            }
        }

        function formatActivityDetails(event) {
            const details = event.details || {};
            switch (event.type) {
                case 'file_save':
                    return details.filePath || 'Unknown file';
                case 'pipeline_run':
                    return `${details.scenario || '?'} - ${details.operation || '?'}`;
                case 'session_start':
                    return 'Session started';
                case 'session_end':
                    const mins = details.durationMinutes;
                    return mins ? `Session ended (${mins} min)` : 'Session ended';
                default:
                    return event.type;
            }
        }

        function renderDashboard(data) {
            if (!data) {
                console.warn('No dashboard data available');
                return;
            }

            // Update summary stats
            const summary = data.summary || {};
            document.getElementById('scenarioCount').textContent = summary.totalScenarios || 0;
            document.getElementById('commitCount').textContent = summary.totalCommits || 0;
            document.getElementById('sessionHours').textContent =
                summary.totalSessionHours || 0;
            document.getElementById('pipelineRuns').textContent = summary.totalPipelineRuns || 0;

            // Update charts
            const charts = data.charts || {};
            const labels = charts.labels || [];

            createChart('commitsChart', 'Commits',
                { labels, values: charts.commits || [] }, '#569cd6');
            createChart('editsChart', 'File Edits',
                { labels, values: charts.fileEdits || [] }, '#4ec9b0');
            createChart('pipelineChart', 'Pipeline Runs',
                { labels, values: charts.pipelineRuns || [] }, '#6a9955');

            // Session hours estimated from git commit patterns
            createChart('sessionChart', 'Hours',
                { labels, values: charts.sessionHours || [] }, '#ce9178');

            // Scenarios worked over time
            createChart('scenariosChart', 'Scenarios',
                { labels, values: charts.scenariosWorked || [] }, '#9333ea');

            // Render recent activity
            const activityList = document.getElementById('recentActivity');
            const recentActivity = (data.recentActivity || []).slice().reverse();
            if (recentActivity.length > 0) {
                activityList.innerHTML = recentActivity.map(event => `
                    <div class="activity-item">
                        <div>
                            <span class="activity-type type-${event.type}">${event.type.replace('_', ' ')}</span>
                            <span style="margin-left: 8px;">${formatActivityDetails(event)}</span>
                        </div>
                        <span class="activity-time">${formatTime(event.timestamp)}</span>
                    </div>
                `).join('');
            }

            // Render recent commits
            const commitsList = document.getElementById('recentCommits');
            const recentCommits = data.recentCommits || [];
            if (recentCommits.length > 0) {
                commitsList.innerHTML = recentCommits.map(commit => `
                    <div class="commit-item">
                        <span class="commit-hash">${commit.hash}</span>
                        <span class="commit-message">${commit.message}</span>
                        <span class="commit-date">${commit.date}</span>
                    </div>
                `).join('');
            }

            // Update timestamp
            if (data.generatedAt) {
                document.getElementById('lastUpdated').textContent = formatTime(data.generatedAt);
            }
        }

        // Load dashboard data
        if (typeof DASHBOARD_DATA !== 'undefined') {
            renderDashboard(DASHBOARD_DATA);
        } else {
            // Try to fetch from JSON file (works with local server)
            fetch('dashboard-data.json')
                .then(r => r.json())
                .then(renderDashboard)
                .catch(() => console.warn('No dashboard data available. Run generateDashboardData.py'));
        }
    </script>
</body>
</html>

produce 40
dealer south

### SOUTH
# Calculate length points for South (lengthPoints)
lp1 = spades(south)>4 ? spades(south)-4 : 0
lp2 = hearts(south)>4 ? hearts(south)-4 : 0
lp3 = diamonds(south)>4 ? diamonds(south)-4 : 0
lp4 = clubs(south)>4 ? clubs(south)-4 : 0
lengthPoints = lp1 + lp2 + lp3 + lp4รง

# Calculate doubleton honor NT downgrade(s) for South -- 2 cards, 1 honor, not the Ace
S2H = spades(south)==2 and top4(south,spades)==1 and not hascard(south,AS) ? 1 : 0
H2H = hearts(south)==2 and top4(south,hearts)==1 and not hascard(south,AH) ? 1 : 0
D2H = diamonds(south)==2 and top4(south,diamonds)==1 and not hascard(south,AD) ? 1 : 0
C2H = clubs(south)==2 and top4(south,clubs)==1 and not hascard(south,AC) ? 1 : 0
ntDownGrade = S2H + H2H + D2H + C2H

# Define notrump points for south (ntPoints)
ntPoints = hcp(south) + lengthPoints - ntDownGrade

# Define suit points for south (suitPoints)
suitPoints = hcp(south) + lengthPoints

# Define robot notrump shape and exclude any 5card 
ntShape = shape(south, any 4333 +any 4432 +any 5332 +any 5422 -5xxx -x5xx)

# Define ntPoint ranges
oneNT = ntShape and ntPoints>14 and ntPoints<18
twoNT = ntShape and ntPoints>19 and ntPoints<22
weakNT = ntShape and ntPoints>10 and ntPoints<15
overcallNT = ntShape and ntPoints>14 and ntPoints<19  // 15-18

### NORTH
# Calculate strength for North -- hcp plus 1 for every card over 4 in any suit 
nlp1 = spades(north)>4 ? spades(north)-4 : 0
nlp2 = hearts(north)>4 ? hearts(north)-4 : 0
nlp3 = diamonds(north)>4 ? diamonds(north)-4 : 0
nlp4 = clubs(north)>4 ? clubs(north)-4 : 0
strength = nlp1 + nlp2 + nlp3 + nlp4 + hcp(north)
combined = ntPoints + strength

partscore = combined=<25
game = combined>=26 and combined<=32
slam = combined>=33

texas = (spades(north)>5 or hearts(north)>5) and not partscore
smolen = shape(north,54xx+45xx) and not partscore
MSS = (diamonds(north)>4 or clubs(north>4) and not partscore
puppet = shape(north,43xx+34xx+33xx) and not partscore
balanced = shape(north,any 4333 +any 4432 +any 5332)not partscore
other = not (texas or smolen or MSS or puppet or balanced)

### Define Leveling
c1 = hascard(west,2C)
c2 = hascard(east,2D)
c3 = hascard(west,3C)
c4 = hascard(east,3D)
c5 = hascard(west,4C)

reduce98 = c1 and c2 and c3
reduce94 = c1 and c2
reduce87 = c1 and (c2 or c3)
reduce75 = c1
reduce62 = (c1 or c2) and not (c3 and (c4 or c5)) 
reduce50 = c1 or c2
reduce38 = not reduce62
reduce25 = not reduce75
reduce13 = not reduce87
reduce06 = not reduce94
reduce02 = not reduce98

levTexas = not texas or 0
levSmolen = not smolen or 0
levPuppet = not puppet or 0
levelMSS = not MSS or 0
levelBalanced = not balanced or 0
levelOther = not other or 0
levelTheCode = (levTexas or levSmolen or levMSS or levPuppet or levBalanced or levOther) 
### Ready for Leveling

### Do it
twoNT
#and levelTheCode

### Generate Statistics
action

action
average "Texas        " texas,
average "Smolen       " smolen,
average "MSS          " MSS,
average "Puppet       " puppet,
average "Balanced     " balanced,
average "Other        " other,

average "Strength         " ntPoints + strength,
average "lengthPoints" lengthPoints,
average "ntDownGrade " ntDownGrade,
average "ntPoints    " ntPoints,
average "strength    " strength,
average "combined    " ntPoints + strength,

action printoneline

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBS Activity Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1100px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        .stat-box {
            background: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #2563eb;
        }
        .stat-label {
            color: #666;
            margin-top: 5px;
            font-size: 14px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .chart-card h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 16px;
        }
        .activity-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .activity-card h3 {
            margin: 0 0 15px 0;
            color: #333;
        }
        .activity-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .activity-list {
            max-height: 250px;
            overflow-y: auto;
        }
        .activity-item {
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .activity-item:last-child {
            border-bottom: none;
        }
        .activity-type {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
        }
        .type-file_save { background: #dbeafe; color: #1d4ed8; }
        .type-pipeline_run { background: #dcfce7; color: #166534; }
        .type-session_start { background: #fef3c7; color: #92400e; }
        .type-session_end { background: #fee2e2; color: #991b1b; }
        .activity-time {
            color: #999;
            font-size: 11px;
        }
        .commit-item {
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        .commit-item:last-child {
            border-bottom: none;
        }
        .commit-hash {
            font-family: monospace;
            color: #6366f1;
            font-size: 12px;
        }
        .commit-message {
            color: #333;
            margin-left: 8px;
        }
        .commit-date {
            color: #999;
            font-size: 11px;
            display: block;
            margin-top: 4px;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #999;
            font-size: 14px;
        }
        .no-data {
            color: #999;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }
        @media (max-width: 768px) {
            .stats { grid-template-columns: repeat(2, 1fr); }
            .chart-grid { grid-template-columns: 1fr; }
            .activity-grid { grid-template-columns: 1fr; }
        }
    </style>
    <script>
const DASHBOARD_DATA = {
  "generatedAt": "2026-01-27T17:04:36.266050",
  "summary": {
    "totalScenarios": 297,
    "totalFileEdits": 14726,
    "totalPipelineRuns": 5,
    "totalSessionHours": 971,
    "totalCommits": 1034
  },
  "charts": {
    "labels": [
      "Feb 25",
      "Mar 25",
      "Apr 25",
      "May 25",
      "Jun 25",
      "Jul 25",
      "Jul 25",
      "Aug 25",
      "Sep 25",
      "Oct 25",
      "Nov 25",
      "Dec 25",
      "Jan 26"
    ],
    "fileEdits": [
      819,
      1572,
      1508,
      3782,
      595,
      314,
      314,
      250,
      870,
      1779,
      678,
      506,
      1942
    ],
    "pipelineRuns": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      5
    ],
    "commits": [
      80,
      132,
      116,
      65,
      66,
      30,
      30,
      21,
      93,
      159,
      80,
      62,
      120
    ],
    "sessionHours": [
      76,
      83,
      112,
      58,
      70,
      37,
      37,
      35,
      100,
      131,
      102,
      69,
      90
    ]
  },
  "recentActivity": [
    {
      "timestamp": "2026-01-27T16:20:36.829Z",
      "type": "session_start",
      "details": {}
    },
    {
      "timestamp": "2026-01-27T16:29:27.259Z",
      "type": "session_end",
      "details": {
        "durationMinutes": 9
      }
    },
    {
      "timestamp": "2026-01-27T16:29:28.836Z",
      "type": "session_start",
      "details": {}
    },
    {
      "timestamp": "2026-01-27T17:39:18.120Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Opps_Michaels_and_Unusual",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-01-27T17:40:52.701Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Opps_Michaels_and_Unusual",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-01-27T17:49:14.054Z",
      "type": "file_save",
      "details": {
        "filePath": "pbs/Opps_Michaels_and_Unusual",
        "fileType": "pbs",
        "scenario": "Opps_Michaels_and_Unusual"
      }
    },
    {
      "timestamp": "2026-01-27T17:49:55.746Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Opps_Michaels_and_Unusual",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-01-27T17:51:15.420Z",
      "type": "file_save",
      "details": {
        "filePath": "dlr/Opps_Michaels_and_Unusual.dlr",
        "fileType": "dlr",
        "scenario": "Opps_Michaels_and_Unusual"
      }
    },
    {
      "timestamp": "2026-01-27T17:51:18.369Z",
      "type": "file_save",
      "details": {
        "filePath": "dlr/Opps_Michaels_and_Unusual.dlr",
        "fileType": "dlr",
        "scenario": "Opps_Michaels_and_Unusual"
      }
    },
    {
      "timestamp": "2026-01-27T17:56:11.085Z",
      "type": "file_save",
      "details": {
        "filePath": "pbs/Opps_Michaels_and_Unusual",
        "fileType": "pbs",
        "scenario": "Opps_Michaels_and_Unusual"
      }
    },
    {
      "timestamp": "2026-01-27T17:56:19.378Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "Opps_Michaels_and_Unusual",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-01-27T18:20:17.170Z",
      "type": "file_save",
      "details": {
        "filePath": "pbs/Opps_Michaels_and_Unusual",
        "fileType": "pbs",
        "scenario": "Opps_Michaels_and_Unusual"
      }
    },
    {
      "timestamp": "2026-01-27T19:43:07.250Z",
      "type": "file_save",
      "details": {
        "filePath": "pbs/GIB_1C-P-Resp",
        "fileType": "pbs",
        "scenario": "GIB_1C-P-Resp"
      }
    },
    {
      "timestamp": "2026-01-27T19:43:40.696Z",
      "type": "file_save",
      "details": {
        "filePath": "pbs/GIB_1C-P-Resp",
        "fileType": "pbs",
        "scenario": "GIB_1C-P-Resp"
      }
    },
    {
      "timestamp": "2026-01-27T19:43:53.509Z",
      "type": "pipeline_run",
      "details": {
        "scenario": "GIB_1C-P-Resp",
        "operation": "*"
      }
    },
    {
      "timestamp": "2026-01-27T20:54:57.643Z",
      "type": "file_save",
      "details": {
        "filePath": "GIB/GIB_Open_In_Fourth_Seat.pbn",
        "fileType": "pbn"
      }
    }
  ],
  "recentCommits": [
    {
      "hash": "87bcb952",
      "date": "2026-01-27 16:57:55 -0600",
      "message": "update dashboard"
    },
    {
      "hash": "d89aadeb",
      "date": "2026-01-27 16:31:05 -0600",
      "message": "Update dashboard with activity data"
    },
    {
      "hash": "96ba0af5",
      "date": "2026-01-27 15:43:48 -0600",
      "message": "capture GIB bidding for Open in Fourth Seat"
    },
    {
      "hash": "21c3f90d",
      "date": "2026-01-27 13:45:35 -0600",
      "message": "add 3316 and 3307 for D splinters"
    },
    {
      "hash": "09862a20",
      "date": "2026-01-27 13:00:24 -0600",
      "message": "Remove redundant 'Opps ' prefix from button text in They Compete section"
    },
    {
      "hash": "d775c7ed",
      "date": "2026-01-27 12:22:10 -0600",
      "message": "Replace comma with wide comma in scenario chat"
    },
    {
      "hash": "aa8e6b0b",
      "date": "2026-01-27 12:16:28 -0600",
      "message": "Add Opps_Michaels_and_Unusual scenario"
    },
    {
      "hash": "ae1b85b9",
      "date": "2026-01-27 10:31:25 -0600",
      "message": "update on VSCode reatart"
    },
    {
      "hash": "20154ffa",
      "date": "2026-01-27 10:29:58 -0600",
      "message": "Add startup refresh to PBS Dashboard"
    },
    {
      "hash": "e1f99e00",
      "date": "2026-01-27 08:41:37 -0600",
      "message": "clean up"
    }
  ]
};
    </script>
</head>
<body>
    <h1>Practice Bidding Scenarios</h1>
    <p class="subtitle">Development Activity Dashboard</p>

    <div class="stats">
        <div class="stat-box">
            <div class="stat-value" id="scenarioCount">-</div>
            <div class="stat-label">Scenarios</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="commitCount">-</div>
            <div class="stat-label">Commits (Year)</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="sessionHours">-</div>
            <div class="stat-label">Hours in VSCode</div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="pipelineRuns">-</div>
            <div class="stat-label">Pipeline Runs</div>
        </div>
    </div>

    <div class="chart-grid">
        <div class="chart-card">
            <h3>Git Commits</h3>
            <canvas id="commitsChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>File Edits</h3>
            <canvas id="editsChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>Pipeline Runs</h3>
            <canvas id="pipelineChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>VSCode Session Time (Hours)</h3>
            <canvas id="sessionChart"></canvas>
        </div>
    </div>

    <div class="activity-grid">
        <div class="activity-card">
            <h3>Recent Activity</h3>
            <div class="activity-list" id="recentActivity">
                <div class="no-data">No activity logged yet</div>
            </div>
        </div>
        <div class="activity-card">
            <h3>Recent Commits</h3>
            <div class="activity-list" id="recentCommits">
                <div class="no-data">No commits found</div>
            </div>
        </div>
    </div>

    <p class="footer">
        Last updated: <span id="lastUpdated">-</span>
        <br>
        <small>Run <code>python3 py/generateDashboardData.py</code> to refresh</small>
    </p>

    <script>
        // Chart configuration defaults
        const chartDefaults = {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { stepSize: 1 }
                }
            }
        };

        function createChart(canvasId, label, data, color) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels || [],
                    datasets: [{
                        label: label,
                        data: data.values || [],
                        backgroundColor: color + '40',
                        borderColor: color,
                        borderWidth: 1
                    }]
                },
                options: chartDefaults
            });
        }

        function formatTime(isoString) {
            try {
                const date = new Date(isoString);
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            } catch {
                return isoString;
            }
        }

        function formatActivityDetails(event) {
            const details = event.details || {};
            switch (event.type) {
                case 'file_save':
                    return details.filePath || 'Unknown file';
                case 'pipeline_run':
                    return `${details.scenario || '?'} - ${details.operation || '?'}`;
                case 'session_start':
                    return 'Session started';
                case 'session_end':
                    const mins = details.durationMinutes;
                    return mins ? `Session ended (${mins} min)` : 'Session ended';
                default:
                    return event.type;
            }
        }

        function renderDashboard(data) {
            if (!data) {
                console.warn('No dashboard data available');
                return;
            }

            // Update summary stats
            const summary = data.summary || {};
            document.getElementById('scenarioCount').textContent = summary.totalScenarios || 0;
            document.getElementById('commitCount').textContent = summary.totalCommits || 0;
            document.getElementById('sessionHours').textContent =
                summary.totalSessionHours || 0;
            document.getElementById('pipelineRuns').textContent = summary.totalPipelineRuns || 0;

            // Update charts
            const charts = data.charts || {};
            const labels = charts.labels || [];

            createChart('commitsChart', 'Commits',
                { labels, values: charts.commits || [] }, '#6366f1');
            createChart('editsChart', 'File Edits',
                { labels, values: charts.fileEdits || [] }, '#2563eb');
            createChart('pipelineChart', 'Pipeline Runs',
                { labels, values: charts.pipelineRuns || [] }, '#16a34a');

            // Session hours estimated from git commit patterns
            createChart('sessionChart', 'Hours',
                { labels, values: charts.sessionHours || [] }, '#ea580c');

            // Render recent activity
            const activityList = document.getElementById('recentActivity');
            const recentActivity = (data.recentActivity || []).slice().reverse();
            if (recentActivity.length > 0) {
                activityList.innerHTML = recentActivity.map(event => `
                    <div class="activity-item">
                        <div>
                            <span class="activity-type type-${event.type}">${event.type.replace('_', ' ')}</span>
                            <span style="margin-left: 8px;">${formatActivityDetails(event)}</span>
                        </div>
                        <span class="activity-time">${formatTime(event.timestamp)}</span>
                    </div>
                `).join('');
            }

            // Render recent commits
            const commitsList = document.getElementById('recentCommits');
            const recentCommits = data.recentCommits || [];
            if (recentCommits.length > 0) {
                commitsList.innerHTML = recentCommits.map(commit => `
                    <div class="commit-item">
                        <span class="commit-hash">${commit.hash}</span>
                        <span class="commit-message">${commit.message}</span>
                        <span class="commit-date">${commit.date}</span>
                    </div>
                `).join('');
            }

            // Update timestamp
            if (data.generatedAt) {
                document.getElementById('lastUpdated').textContent = formatTime(data.generatedAt);
            }
        }

        // Load dashboard data
        if (typeof DASHBOARD_DATA !== 'undefined') {
            renderDashboard(DASHBOARD_DATA);
        } else {
            // Try to fetch from JSON file (works with local server)
            fetch('dashboard-data.json')
                .then(r => r.json())
                .then(renderDashboard)
                .catch(() => console.warn('No dashboard data available. Run generateDashboardData.py'));
        }
    </script>
</body>
</html>
